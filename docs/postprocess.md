# Постобработка, шаблоны стран и антидубликаты (Шаг 5)

На этом шаге добавлен модуль `Postprocessor`, который формализует требования
ТЗ к нормализации результатов OCR, проверке шаблонов стран и подавлению
дубликатов.

## Поток
1. OCR кандидаты фильтруются по `min_confidence`.
2. При `vote_by_char=true` применяется посимвольное голосование по всем
   кандидатам; иначе берётся лучший по уверенности.
3. Строка нормализуется: удаляются пробелы/дефисы, приводится к верхнему
   регистру и корректируются похожие символы (`0/O`, `1/I`, `B/8`, `Z/2`,
   `C/С`).
4. Номер проверяется на соответствие включённым шаблонам стран.
5. Антидубликат: если номер встречался в течение `anti_duplicate_seconds`,
   событие помечается как дубликат.
6. Минимальное число кадров с номером контролируется параметром
   `min_frames_for_event`.

## Конфигурация окружения
- `POSTPROCESS_VOTE_BY_CHAR` — вкл/выкл голосование по символам (default `true`).
- `POSTPROCESS_MIN_CONFIDENCE` — минимальная уверенность OCR кандидата
  (default `0.55`).
- `POSTPROCESS_MIN_FRAMES_FOR_EVENT` — минимальное число кадров с номером для
  фиксации события (default `3`).
- `POSTPROCESS_ANTI_DUPLICATE_SECONDS` — окно подавления дубликатов (default `5`).
- `POSTPROCESS_COUNTRY_TEMPLATES` — список включённых шаблонов стран
  (`ru,by,kz,ua,eu`), соответствует регулярным выражениям внутри модуля.

## API
- `GET /api/v1/pipeline/status` — дополнен секцией `postprocess` с текущими
  настройками (шаблоны стран, пороги, антидубликаты).

## Следующие шаги
- Интеграция postprocessor с Rules Engine и Event Manager для фактического
  создания событий и применения сценариев (шаги 6–7).
- Расширение набора шаблонов/регионов по требованиям эксплуатации.
