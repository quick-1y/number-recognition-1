# Rules, Lists, and Scenarios

## Plate lists
- **Типы:** белый, чёрный, информационный.
- **Поля списка:** название, тип, приоритет, TTL, расписание (интервалы активности), описание.
- **Элементы:** номер или шаблон, комментарий, TTL/дата истечения.
- **Импорт/экспорт:** CSV/JSON (задаётся в будущих шагах API).

### Модель БД (шаг 6)
- `plate_lists`: `id`, `name`, `type`, `priority`, `ttl_seconds`, `schedule`, `description`, `created_at`, `updated_at`.
- `plate_list_items`: `id`, `plate_list_id`, `pattern`, `comment`, `ttl_seconds`, `expires_at`, `created_at`, `updated_at`.

## Rules Engine
- **Условия (IF):** тип/идентификатор списка, канал, время суток/расписание, минимальная уверенность OCR, направление движения, антифлуд (cooldown), минимальное число кадров.
- **Действия (THEN):** реле (режимы), webhook (JSON, HMAC), запись клипа до/после события, метки для UI.
- **Конфигурация:** значения по умолчанию читаются из окружения (cooldown, минимальная уверенность, дефолтные действия).
- **Статус:** описывается через `/api/v1/rules/status` и отображает активные списки, условия и действия по умолчанию.

## API заготовки
- `POST /api/v1/lists` — создать список с приоритетом/TTL/расписанием.
- `POST /api/v1/lists/{list_id}/items` — добавить элемент (номер/шаблон).
- `GET /api/v1/lists` — получить текущие списки и элементы.
- `GET /api/v1/rules/status` — состояние Rules Engine и базовые условия/действия.

> Полноценные сценарии IF→THEN будут доработаны на этапе API/авторизации (шаг 8) вместе с UI.
